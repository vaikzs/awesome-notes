"use strict";(self.webpackChunkawesome_notes=self.webpackChunkawesome_notes||[]).push([[3668],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return c}});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var o=n.createContext({}),u=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(o.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,i=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(a),c=l,k=d["".concat(o,".").concat(c)]||d[c]||m[c]||i;return a?n.createElement(k,r(r({ref:t},p),{},{components:a})):n.createElement(k,r({ref:t},p))}));function c(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=a.length,r=new Array(i);r[0]=d;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:l,r[1]=s;for(var u=2;u<i;u++)r[u]=a[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6694:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return o},default:function(){return c},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return m}});var n=a(7462),l=a(3366),i=(a(7294),a(3905)),r=["components"],s={author:"Sabertazimi",authorTitle:"Web Developer",authorURL:"https://github.com/sabertazimi",authorImageURL:"https://github.com/sabertazimi.png",tags:["CS","System","Virtualization"]},o="Virtualization Basic Notes",u={unversionedId:"computerScience/virtualization/virtualBasicNotes",id:"computerScience/virtualization/virtualBasicNotes",title:"Virtualization Basic Notes",description:"How to read paper",source:"@site/notes/computerScience/virtualization/virtualBasicNotes.md",sourceDirName:"computerScience/virtualization",slug:"/computerScience/virtualization/virtualBasicNotes",permalink:"/awesome-notes/computerScience/virtualization/virtualBasicNotes",editUrl:"https://github.com/sabertazimi/awesome-notes/edit/main/notes/computerScience/virtualization/virtualBasicNotes.md",tags:[{label:"CS",permalink:"/awesome-notes/tags/cs"},{label:"System",permalink:"/awesome-notes/tags/system"},{label:"Virtualization",permalink:"/awesome-notes/tags/virtualization"}],version:"current",lastUpdatedBy:"sabertazimi",lastUpdatedAt:1648310706,formattedLastUpdatedAt:"3/26/2022",frontMatter:{author:"Sabertazimi",authorTitle:"Web Developer",authorURL:"https://github.com/sabertazimi",authorImageURL:"https://github.com/sabertazimi.png",tags:["CS","System","Virtualization"]},sidebar:"sidebar",previous:{title:"Operating System Basic Notes",permalink:"/awesome-notes/computerScience/operatingSystems/operatingSystemsBasicNotes"},next:{title:"Android Basic Notes",permalink:"/awesome-notes/programming/android/androidBasicNotes"}},p={},m=[{value:"How to read paper",id:"how-to-read-paper",level:2},{value:"LXC",id:"lxc",level:2},{value:"Linux Namespaces",id:"linux-namespaces",level:3},{value:"chroot",id:"chroot",level:3},{value:"Control Groups",id:"control-groups",level:3},{value:"In-Memory Computing Thesis Notes",id:"in-memory-computing-thesis-notes",level:2},{value:"\u5355\u8282\u70b9\u5185\u5b58\u8ba1\u7b97",id:"\u5355\u8282\u70b9\u5185\u5b58\u8ba1\u7b97",level:3},{value:"\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf",id:"\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf",level:4},{value:"\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf",id:"\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf",level:4},{value:"\u5185\u5b58\u538b\u7f29\u6280\u672f",id:"\u5185\u5b58\u538b\u7f29\u6280\u672f",level:4},{value:"\u63d0\u5347 I/O \u8bbf\u95ee\u6548\u7387",id:"\u63d0\u5347-io-\u8bbf\u95ee\u6548\u7387",level:4},{value:"\u5206\u5e03\u5f0f\u5185\u5b58\u8ba1\u7b97",id:"\u5206\u5e03\u5f0f\u5185\u5b58\u8ba1\u7b97",level:3},{value:"\u5206\u5e03\u5f0f\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf",id:"\u5206\u5e03\u5f0f\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf",level:4},{value:"\u5185\u5b58\u7f13\u5b58\u7cfb\u7edf",id:"\u5185\u5b58\u7f13\u5b58\u7cfb\u7edf",level:4},{value:"\u5206\u5e03\u5f0f\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf",id:"\u5206\u5e03\u5f0f\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf",level:4},{value:"\u6df7\u5408\u5185\u5b58\u8ba1\u7b97",id:"\u6df7\u5408\u5185\u5b58\u8ba1\u7b97",level:3},{value:"Hadoop Thesis Notes",id:"hadoop-thesis-notes",level:2},{value:"Google File System",id:"google-file-system",level:3},{value:"\u57fa\u672c\u8bbe\u8ba1",id:"\u57fa\u672c\u8bbe\u8ba1",level:4},{value:"\u5143\u6570\u636e",id:"\u5143\u6570\u636e",level:5},{value:"Chunk \u5c3a\u5bf8",id:"chunk-\u5c3a\u5bf8",level:5},{value:"\u4e00\u81f4\u6027\u6a21\u578b",id:"\u4e00\u81f4\u6027\u6a21\u578b",level:5},{value:"Chunk \u526f\u672c\u4fee\u6539\u4e00\u81f4\u6027",id:"chunk-\u526f\u672c\u4fee\u6539\u4e00\u81f4\u6027",level:6},{value:"\u7cfb\u7edf\u4ea4\u4e92",id:"\u7cfb\u7edf\u4ea4\u4e92",level:4},{value:"\u79df\u7ea6\u673a\u5236",id:"\u79df\u7ea6\u673a\u5236",level:5},{value:"\u6570\u636e\u6d41",id:"\u6570\u636e\u6d41",level:5},{value:"\u539f\u5b50\u8ffd\u52a0\u64cd\u4f5c",id:"\u539f\u5b50\u8ffd\u52a0\u64cd\u4f5c",level:5},{value:"\u5feb\u7167",id:"\u5feb\u7167",level:5},{value:"Master \u8282\u70b9",id:"master-\u8282\u70b9",level:4},{value:"\u540d\u79f0\u7a7a\u95f4\u9501",id:"\u540d\u79f0\u7a7a\u95f4\u9501",level:5},{value:"Chunk \u526f\u672c\u5e73\u8861",id:"chunk-\u526f\u672c\u5e73\u8861",level:5},{value:"\u5783\u573e\u56de\u6536",id:"\u5783\u573e\u56de\u6536",level:5},{value:"\u5bb9\u9519\u6027",id:"\u5bb9\u9519\u6027",level:4},{value:"Map Reduce",id:"map-reduce",level:3},{value:"Google Big Table",id:"google-big-table",level:3},{value:"\u6570\u636e\u6a21\u578b",id:"\u6570\u636e\u6a21\u578b",level:4},{value:"\u884c",id:"\u884c",level:5},{value:"\u5217\u65cf",id:"\u5217\u65cf",level:5},{value:"\u65f6\u95f4\u6233",id:"\u65f6\u95f4\u6233",level:5},{value:"\u4f9d\u8d56",id:"\u4f9d\u8d56",level:4},{value:"SSTable",id:"sstable",level:5},{value:"Chubby",id:"chubby",level:5},{value:"\u7ec4\u4ef6",id:"\u7ec4\u4ef6",level:4},{value:"Master \u670d\u52a1\u5668",id:"master-\u670d\u52a1\u5668",level:5},{value:"Tablet \u670d\u52a1\u5668",id:"tablet-\u670d\u52a1\u5668",level:5},{value:"\u5b9e\u73b0",id:"\u5b9e\u73b0",level:4},{value:"\u5b9a\u4f4d",id:"\u5b9a\u4f4d",level:5},{value:"\u670d\u52a1",id:"\u670d\u52a1",level:5},{value:"Unikernel",id:"unikernel",level:2},{value:"Unikernels",id:"unikernels",level:3},{value:"Security",id:"security",level:4},{value:"Debug",id:"debug",level:4},{value:"Limits",id:"limits",level:4},{value:"Ecosystem",id:"ecosystem",level:4},{value:"ClickOS",id:"clickos",level:5},{value:"RumpRun",id:"rumprun",level:5},{value:"OSv",id:"osv",level:5},{value:"Mini-OS",id:"mini-os",level:5},{value:"Xen",id:"xen",level:5},{value:"Unik",id:"unik",level:5},{value:"libOS",id:"libos",level:3},{value:"OPAM",id:"opam",level:3},{value:"MirageOS",id:"mirageos",level:3},{value:"Installation",id:"installation",level:4},{value:"Development",id:"development",level:4},{value:"Use of OCaml",id:"use-of-ocaml",level:4},{value:"Concurrency",id:"concurrency",level:5},{value:"Thread Flow",id:"thread-flow",level:5},{value:"Device Drivers",id:"device-drivers",level:4},{value:"I/O Stack",id:"io-stack",level:4},{value:"Xen Soft Device",id:"xen-soft-device",level:2},{value:"Device Access in Xen",id:"device-access-in-xen",level:3},{value:"Memory Management",id:"memory-management",level:2},{value:"Direct Segment",id:"direct-segment",level:3},{value:"Large Pages Shortcoming",id:"large-pages-shortcoming",level:4},{value:"Big-memory workload analysis",id:"big-memory-workload-analysis",level:4},{value:"Hardware Support",id:"hardware-support",level:4},{value:"Software Support",id:"software-support",level:4},{value:"Virtual Machines with Direct Segment",id:"virtual-machines-with-direct-segment",level:4},{value:"Results",id:"results",level:4},{value:"Redundant Memory Mappings (RMM)",id:"redundant-memory-mappings-rmm",level:3},{value:"Old Methods",id:"old-methods",level:4},{value:"Multi Page mapping",id:"multi-page-mapping",level:4},{value:"Transparent Huge pages",id:"transparent-huge-pages",level:4},{value:"Direct Segment Method",id:"direct-segment-method",level:4},{value:"New Methods",id:"new-methods",level:4},{value:"RMM Benefits",id:"rmm-benefits",level:4},{value:"Range Translation",id:"range-translation",level:4},{value:"Range Table",id:"range-table",level:4},{value:"Contiguous Memory Allocation",id:"contiguous-memory-allocation",level:4}],d={toc:m};function c(e){var t=e.components,a=(0,l.Z)(e,r);return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"virtualization-basic-notes"},"Virtualization Basic Notes"),(0,i.kt)("h2",{id:"how-to-read-paper"},"How to read paper"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"abstract, introduction, related works, conclusion"),(0,i.kt)("li",{parentName:"ul"},"reference"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"paper refers it")," (by Google Scholar)")),(0,i.kt)("h2",{id:"lxc"},"LXC"),(0,i.kt)("h3",{id:"linux-namespaces"},"Linux Namespaces"),(0,i.kt)("p",null,"LXC \u6240\u5b9e\u73b0\u7684\u9694\u79bb\u6027\u4e3b\u8981\u662f\u6765\u81ea\u5185\u6838\u7684\u547d\u540d\u7a7a\u95f4"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"PID Namespace: \u9694\u79bb\u8fdb\u7a0b"),(0,i.kt)("li",{parentName:"ul"},"Network Namespace: \u9694\u79bb\u7f51\u7edc"),(0,i.kt)("li",{parentName:"ul"},"IPC Namespace: \u9694\u79bb\u6d88\u606f"),(0,i.kt)("li",{parentName:"ul"},"Mount Namespace: \u9694\u79bb\u6587\u4ef6\u7cfb\u7edf"),(0,i.kt)("li",{parentName:"ul"},"UTS Namespace: \u9694\u79bb hostname"),(0,i.kt)("li",{parentName:"ul"},"Users Namespace")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "log"\n    "os"\n    "os/exec"\n    "syscall"\n)\n\nfunc main() {\n    switch os.Args[1] {\n    case "run":\n        run()\n    case "child":\n        child()\n    default:\n        log.Fatal("Invalid command")\n    }\n}\n\nfunc run() {\n    cmd := exec.Command("/proc/self/exe", append([]string{"child"}, os.Args[2:]...)...)\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.SysProcAttr = &syscall.SysProcAttr {\n        CloneFlags: syscall.CLONE_NEWUTS | syscall.CLONE_NEWPID\n          | syscall.CLONE_NEWNS | syscall.CLONE_NEWUSER,\n        Credential: &syscall.Credential{Uid: 0, Gid: 0},\n        UidMappings: []syscall.SysProcIDMap{\n            {ContainerID: 0, HostID: os.Getuid(), Size: 1},\n        },\n        GidMappings: []syscall.SysProcIDMap{\n            {ContainerID: 0, HostID: os.Getgid(), Size: 1},\n        },\n    }\n\n    must(cmd.Run())\n}\n\nfunc child() {\n    log.Printf("running %v as PID %d\\n", os.Args[2:], os.Getpid())\n\n    // cg()\n\n    cmd := exec.Command(os.Args[2], os.Args[3:]...)\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n\n    must(syscall.Sethostname([]byte("mocker")))\n    must(syscall.Chroot("/home/sabertazimi/rootfs"))\n    must(syscall.Chdir("/"))\n    must(syscall.Mount("proc", "proc", "proc", 0, ""))\n    must(cmd.Run())\n    must(syscall.Unmount("proc", 0))\n}\n\nfunc must(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n')),(0,i.kt)("h3",{id:"chroot"},"chroot"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'must(syscall.Chroot("/home/sabertazimi/rootfs"))\nmust(syscall.Chdir("/"))\nmust(syscall.Mount("proc", "proc", "proc", 0, ""))\n')),(0,i.kt)("h3",{id:"control-groups"},"Control Groups"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"cgroups"),", resources limitation:\nCPU, Memory, Disk I/O,\nProcess numbers, Network, Device."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'func cg() {\n    cgroups := "/sys/fs/cgroup/"\n    pids := filepath.Join(cgroups, "pids")\n    os.Mkdir(filepath.Join(pids, "sabertazimi"), 0755)\n    must(ioutil.WriteFile(filepath.Join(pids, "sabertazimi/pids.max"),\n      []byte("20"), 0700))\n    must(ioutil.WriteFile(filepath.Join(pids, "sabertazimi/notify_on_release"),\n      []byte("1"), 0700))\n    must(ioutil.WriteFile(filepath.Join(pids, "sabertazimi/cgroup.procs"),\n      []byte(strconv.Itoa(os.Getpid())), 0700))\n}\n')),(0,i.kt)("p",null,"\u5927\u6570\u636e\u5904\u7406\u5178\u578b\u95ee\u9898:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898"),(0,i.kt)("li",{parentName:"ul"},"\u6570\u636e\u5bb9\u9519\u4e0e\u6062\u590d\u95ee\u9898"),(0,i.kt)("li",{parentName:"ul"},"\u8282\u70b9\u901a\u4fe1\u95ee\u9898"),(0,i.kt)("li",{parentName:"ul"},"\u80fd\u8017\u95ee\u9898")),(0,i.kt)("h2",{id:"in-memory-computing-thesis-notes"},"In-Memory Computing Thesis Notes"),(0,i.kt)("p",null,"\u5185\u5b58\u8ba1\u7b97\u7279\u70b9:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u786c\u4ef6: \u5927\u5185\u5b58"),(0,i.kt)("li",{parentName:"ul"},"\u8f6f\u4ef6: \u826f\u597d\u7f16\u7a0b\u6a21\u578b\u548c\u7f16\u7a0b\u63a5\u53e3"),(0,i.kt)("li",{parentName:"ul"},"\u9762\u5411\u6570\u636e\u5bc6\u96c6\u578b\u5e94\u7528: \u6570\u636e\u89c4\u6a21\u5927, \u5b9e\u65f6\u6027\u8981\u6c42\u9ad8"),(0,i.kt)("li",{parentName:"ul"},"\u5927\u591a\u652f\u6301\u5e76\u884c\u5904\u7406\u6570\u636e")),(0,i.kt)("p",null,"\u5185\u5b58\u8ba1\u7b97\u5206\u7c7b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5355\u8282\u70b9"),(0,i.kt)("li",{parentName:"ul"},"\u5206\u5e03\u5f0f\u96c6\u7fa4"),(0,i.kt)("li",{parentName:"ul"},"\u65b0\u578b\u6df7\u5408\u5185\u5b58 (Hybrid Memory)")),(0,i.kt)("h3",{id:"\u5355\u8282\u70b9\u5185\u5b58\u8ba1\u7b97"},"\u5355\u8282\u70b9\u5185\u5b58\u8ba1\u7b97"),(0,i.kt)("p",null,"\u8282\u70b9\u62e5\u6709 1/n \u4e2a\u5904\u7406\u5668(\u5355/\u591a\u6838) + \u5171\u4eab\u5185\u5b58 (Shared Memory)"),(0,i.kt)("h4",{id:"\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf"},"\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf"),(0,i.kt)("h4",{id:"\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf"},"\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf"),(0,i.kt)("h4",{id:"\u5185\u5b58\u538b\u7f29\u6280\u672f"},"\u5185\u5b58\u538b\u7f29\u6280\u672f"),(0,i.kt)("h4",{id:"\u63d0\u5347-io-\u8bbf\u95ee\u6548\u7387"},"\u63d0\u5347 I/O \u8bbf\u95ee\u6548\u7387"),(0,i.kt)("h3",{id:"\u5206\u5e03\u5f0f\u5185\u5b58\u8ba1\u7b97"},"\u5206\u5e03\u5f0f\u5185\u5b58\u8ba1\u7b97"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bb9\u9519\u4e0e\u6062\u590d"),(0,i.kt)("li",{parentName:"ul"},"\u540c\u6b65\u4e0e\u4e00\u81f4\u6027"),(0,i.kt)("li",{parentName:"ul"},"\u5185\u5b58\u5206\u914d\u4e0e\u7ba1\u7406"),(0,i.kt)("li",{parentName:"ul"},"\u7f51\u7edc\u74f6\u9888")),(0,i.kt)("h4",{id:"\u5206\u5e03\u5f0f\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf"},"\u5206\u5e03\u5f0f\u5185\u5b58\u5b58\u50a8\u7cfb\u7edf"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5185\u5b58\u538b\u7f29\u6280\u672f")),(0,i.kt)("h4",{id:"\u5185\u5b58\u7f13\u5b58\u7cfb\u7edf"},"\u5185\u5b58\u7f13\u5b58\u7cfb\u7edf"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5185\u5b58\u66ff\u6362\u7b56\u7565: LRU, LFU"),(0,i.kt)("li",{parentName:"ul"},"\u9884\u53d6\u6280\u672f")),(0,i.kt)("h4",{id:"\u5206\u5e03\u5f0f\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf"},"\u5206\u5e03\u5f0f\u5185\u5b58\u6570\u636e\u5904\u7406\u7cfb\u7edf"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Spark")),(0,i.kt)("h3",{id:"\u6df7\u5408\u5185\u5b58\u8ba1\u7b97"},"\u6df7\u5408\u5185\u5b58\u8ba1\u7b97"),(0,i.kt)("p",null,"\u94c1\u7535\u5b58\u50a8\u5668: Ferroelectric Random Access Memory, \u7b80\u79f0 FeRAM\n\u76f8\u53d8\u5b58\u50a8\u5668: Phase Change Memory, \u7b80\u79f0 PCM\n\u7535\u963b\u5b58\u50a8\u5668: Resistive Random Access Memory, \u7b80\u79f0 RRAM"),(0,i.kt)("h2",{id:"hadoop-thesis-notes"},"Hadoop Thesis Notes"),(0,i.kt)("h3",{id:"google-file-system"},"Google File System"),(0,i.kt)("h4",{id:"\u57fa\u672c\u8bbe\u8ba1"},"\u57fa\u672c\u8bbe\u8ba1"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8fc5\u901f\u5730\u4fa6\u6d4b\u3001\u5197\u4f59\u5e76\u6062\u590d\u5931\u6548\u7684\u7ec4\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5b58\u50a8\u4e00\u5b9a\u6570\u91cf\u7684\u5927\u6587\u4ef6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5927\u89c4\u6a21\u7684\u6d41\u5f0f\u8bfb\u53d6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5c0f\u89c4\u6a21\u7684\u968f\u673a\u8bfb\u53d6")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5927\u89c4\u6a21\u7684\u3001\u987a\u5e8f\u7684\u3001\u6570\u636e\u8ffd\u52a0\u65b9\u5f0f\u7684\u5199\u64cd\u4f5c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5c0f\u89c4\u6a21\u7684\u968f\u673a\u4f4d\u7f6e\u5199\u5165\u64cd\u4f5c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u9ad8\u6027\u80fd\u7684\u7a33\u5b9a\u7f51\u7edc\u5e26\u5bbd\u8fdc\u6bd4\u4f4e\u5ef6\u8fdf\u91cd\u8981")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5ba2\u6237\u7aef\u548c Master \u8282\u70b9\u7684\u901a\u4fe1\u53ea\u83b7\u53d6\u5143\u6570\u636e\uff0c\u6240\u6709\u7684\u6570\u636e\u64cd\u4f5c\u90fd\u662f\u7531\u5ba2\u6237\u7aef\u76f4\u63a5\u548c Chunk \u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u4e92\u7684")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u65e0\u8bba\u662f\u5ba2\u6237\u7aef\u8fd8\u662f Chunk \u670d\u52a1\u5668\u90fd\u4e0d\u9700\u8981\u7f13\u5b58\u6587\u4ef6\u6570\u636e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u51fa\u4e8e\u53ef\u9760\u6027\u7684\u8003\u8651, \u6bcf\u4e2a\u5757\u90fd\u4f1a\u590d\u5236\u5230\u591a\u4e2a\u5757\u670d\u52a1\u5668\u4e0a.\u7f3a\u7701\u60c5\u51b5\u4e0b, \u6211\u4eec\u4f7f\u7528 3 \u4e2a\u5b58\u50a8\u590d\u5236\u8282\u70b9."))),(0,i.kt)("h5",{id:"\u5143\u6570\u636e"},"\u5143\u6570\u636e"),(0,i.kt)("p",null,"Master \u8282\u70b9\u4e3b\u8981\u5b58\u50a8\u4e09\u79cd\u7c7b\u578b\u5143\u6570\u636e (\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d, \u8f6e\u8be2 Chunk \u670d\u52a1\u5668/\u5468\u671f\u5fc3\u8df3\u4fe1\u606f\u6765\u66f4\u65b0\u5143\u6570\u636e):"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6587\u4ef6\u548c Chunk \u7684\u547d\u540d\u7a7a\u95f4"),(0,i.kt)("li",{parentName:"ul"},"\u6587\u4ef6\u548c Chunk \u7684\u5bf9\u5e94\u5173\u7cfb"),(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a Chunk \u526f\u672c\u7684\u5b58\u653e\u5730\u70b9")),(0,i.kt)("p",null,"\u5143\u6570\u636e\u64cd\u4f5c\u65e5\u5fd7:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5148\u5199\u65e5\u5fd7\u518d\u54cd\u5e94\u8bf7\u6c42"),(0,i.kt)("li",{parentName:"ul"},"Checkpoint \u6587\u4ef6")),(0,i.kt)("h5",{id:"chunk-\u5c3a\u5bf8"},"Chunk \u5c3a\u5bf8"),(0,i.kt)("p",null,"\u8f83\u5927\u7684 Chunk \u5c3a\u5bf8:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u964d\u4f4e\u5143\u6570\u636e\u8bfb\u53d6\u5de5\u4f5c\u548c\u7f13\u5b58\u5de5\u4f5c\u6210\u672c"),(0,i.kt)("li",{parentName:"ul"},"\u591a\u6b21\u64cd\u4f5c\u96c6\u4e2d\u5728\u5c11\u6570 Chunk \u4e0a")),(0,i.kt)("h5",{id:"\u4e00\u81f4\u6027\u6a21\u578b"},"\u4e00\u81f4\u6027\u6a21\u578b"),(0,i.kt)("h6",{id:"chunk-\u526f\u672c\u4fee\u6539\u4e00\u81f4\u6027"},"Chunk \u526f\u672c\u4fee\u6539\u4e00\u81f4\u6027"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bf9 Chunk \u7684\u6240\u6709\u526f\u672c\u7684\u4fee\u6539\u64cd\u4f5c\u987a\u5e8f\u4e00\u81f4"),(0,i.kt)("li",{parentName:"ul"},"\u6839\u636e\u7248\u672c\u53f7\u5224\u65ad Chunk \u662f\u5426\u5931\u6548 (\u672a\u6210\u529f\u8fdb\u884c\u67d0\u6b21\u4fee\u6539), \u4f7f\u7528\u5783\u573e\u6536\u96c6\u7cfb\u7edf\u56de\u6536\u5931\u6548 Chunk")),(0,i.kt)("p",null,"\u5f53\u67d0\u4e2a Chunk \u526f\u672c\u5931\u6548, \u79f0\u4e3a\u4e0d\u53ef\u7528; \u5f53\u6240\u6709 Chunk \u526f\u672c\u5931\u6548, \u79f0\u4e3a\u635f\u574f"),(0,i.kt)("h4",{id:"\u7cfb\u7edf\u4ea4\u4e92"},"\u7cfb\u7edf\u4ea4\u4e92"),(0,i.kt)("p",null,"\u539f\u5219: \u51cf\u5c0f Master \u8d1f\u62c5"),(0,i.kt)("h5",{id:"\u79df\u7ea6\u673a\u5236"},"\u79df\u7ea6\u673a\u5236"),(0,i.kt)("p",null,"Master \u4e3a\u67d0\u4e2a Chunk \u5efa\u7acb\u79df\u7ea6, \u79f0\u4e3a\u4e3b Chunk: \u4fee\u6539\u987a\u5e8f\u7531\u4e3b Chunk \u8fdb\u884c\u7ba1\u7406, \u4ece\u800c\u51cf\u5c0f Master \u7ba1\u7406\u8d1f\u62c5:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Client \u4e0e Master \u901a\u4fe1, \u83b7\u53d6\u4e3b Chunk \u4fe1\u606f"),(0,i.kt)("li",{parentName:"ul"},"Client \u5c06\u6570\u636e\u4f20\u81f3\u6240\u6709 Chunk \u526f\u672c"),(0,i.kt)("li",{parentName:"ul"},"Client \u5c06\u64cd\u4f5c\u53d1\u9001\u81f3\u4e3b Chunk"),(0,i.kt)("li",{parentName:"ul"},"\u4e3b Chunk \u4e3a\u6240\u6709\u64cd\u4f5c\u5206\u914d\u8fde\u7eed\u7684\u5e8f\u5217\u53f7, \u6240\u6709\u526f\u672c\u6309\u7167\u5e8f\u5217\u53f7\u987a\u5e8f\u6267\u884c\u64cd\u4f5c, \u5e76\u5728\u5b8c\u6210\u540e\u56de\u590d\u4e3b Chunk"),(0,i.kt)("li",{parentName:"ul"},"\u4e3b Chunk \u56de\u590d Client")),(0,i.kt)("p",null,"\u5b9e\u9645\u4e0a, \u5ba2\u6237\u7aef\u901a\u5e38\u4f1a\u5728\u4e00\u6b21\u8bf7\u6c42\u4e2d\u67e5\u8be2\u591a\u4e2a Chunk \u4fe1\u606f, Master \u8282\u70b9\u7684\u56de\u5e94\u4e5f\u53ef\u80fd\u5305\u542b\u4e86\u7d27\u8ddf\u7740\u8fd9\u4e9b\u88ab\u8bf7\u6c42\u7684 Chunk \u540e\u9762\u7684 Chunk \u7684\u4fe1\u606f.\n\u5728\u5b9e\u9645\u5e94\u7528\u4e2d, \u8fd9\u4e9b\u989d\u5916\u7684\u4fe1\u606f\u5728\u6ca1\u6709\u4efb\u4f55\u4ee3\u4ef7\u7684\u60c5\u51b5\u4e0b, \u907f\u514d\u4e86\u5ba2\u6237\u7aef\u548c Master \u8282\u70b9\u672a\u6765\u53ef\u80fd\u4f1a\u53d1\u751f\u7684\u51e0\u6b21\u901a\u8baf."),(0,i.kt)("h5",{id:"\u6570\u636e\u6d41"},"\u6570\u636e\u6d41"),(0,i.kt)("p",null,"\u94fe\u5f0f\u987a\u5e8f\u6700\u8fd1\u63a8\u9001\u539f\u5219: \u63a8\u9001\u81f3\u8ddd\u79bb\u6700\u8fd1 (IP \u5730\u5740) \u7684\u4e00\u4e2a\u4e0b\u6e38"),(0,i.kt)("h5",{id:"\u539f\u5b50\u8ffd\u52a0\u64cd\u4f5c"},"\u539f\u5b50\u8ffd\u52a0\u64cd\u4f5c"),(0,i.kt)("p",null,"GFS \u5e76\u4e0d\u4fdd\u8bc1 Chunk \u7684\u6240\u6709\u526f\u672c\u5728\u5b57\u8282\u7ea7\u522b\u662f\u5b8c\u5168\u4e00\u81f4\u7684\u3002\u5b83\u53ea\u4fdd\u8bc1\u6570\u636e\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u539f\u5b50\u7684\u88ab\u81f3\u5c11\u5199\u5165\u4e00\u6b21"),(0,i.kt)("h5",{id:"\u5feb\u7167"},"\u5feb\u7167"),(0,i.kt)("p",null,"copy-on-write \u6280\u672f\u5b9e\u73b0\u5feb\u7167"),(0,i.kt)("p",null,"\u5f53 Master \u8282\u70b9\u6536\u5230\u4e00\u4e2a\u5feb\u7167\u8bf7\u6c42\uff0c\u5b83\u9996\u5148\u53d6\u6d88\u4f5c\u5feb\u7167\u7684\u6587\u4ef6\u7684\u6240\u6709 Chunk \u7684\u79df\u7ea6\u3002\u8fd9\u4e2a\u63aa\u65bd\u4fdd\u8bc1\u4e86\u540e\u7eed\u5bf9\u8fd9\u4e9b Chunk \u7684\u5199\u64cd\u4f5c\u90fd\u5fc5\u987b\u4e0e Master \u4ea4\u4e92\u4ee5\u627e\u5230\u79df\u7ea6\u6301\u6709\u8005"),(0,i.kt)("p",null,"Master \u8282\u70b9\u901a\u8fc7\u590d\u5236\u6e90\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u7684\u5143\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u628a\u8fd9\u6761\u65e5\u5fd7\u8bb0\u5f55\u7684\u53d8\u5316\u53cd\u6620\u5230\u4fdd\u5b58\u5728\u5185\u5b58\u7684\u72b6\u6001\u4e2d\u3002\u65b0\u521b\u5efa\u7684\u5feb\u7167\u6587\u4ef6\u548c\u6e90\u6587\u4ef6\u6307\u5411\u5b8c\u5168\u76f8\u540c\u7684 Chunk \u5730\u5740\u3002"),(0,i.kt)("p",null,"\u786e\u4fdd\u6570\u636e\u5728\u672c\u5730\u590d\u5236\u800c\u4e0d\u662f\u901a\u8fc7\u7f51\u7edc\u590d\u5236"),(0,i.kt)("h4",{id:"master-\u8282\u70b9"},"Master \u8282\u70b9"),(0,i.kt)("p",null,"Master \u8282\u70b9\u7ba1\u7406\u6240\u6709\u7684\u6587\u4ef6\u7cfb\u7edf\u5143\u6570\u636e"),(0,i.kt)("p",null,"\u5143\u6570\u636e\u5305\u62ec:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u540d\u5b57\u7a7a\u95f4"),(0,i.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u63a7\u5236\u4fe1\u606f"),(0,i.kt)("li",{parentName:"ul"},"\u6587\u4ef6\u548c Chunk \u7684\u6620\u5c04\u4fe1\u606f"),(0,i.kt)("li",{parentName:"ul"},"\u5f53\u524d Chunk \u7684\u4f4d\u7f6e\u4fe1\u606f")),(0,i.kt)("p",null,"Master \u8282\u70b9\u57fa\u672c\u5de5\u4f5c:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6267\u884c\u6240\u6709\u7684\u540d\u79f0\u7a7a\u95f4\u64cd\u4f5c"),(0,i.kt)("li",{parentName:"ul"},"\u7ba1\u7406\u7740\u6574\u4e2a\u7cfb\u7edf\u91cc\u6240\u6709 Chunk \u7684\u526f\u672c:\n\u51b3\u5b9a Chunk \u7684\u5b58\u50a8\u4f4d\u7f6e, \u521b\u5efa\u65b0 Chunk \u548c\u5b83\u7684\u526f\u672c,\n\u534f\u8c03\u5404\u79cd\u5404\u6837\u7684\u7cfb\u7edf\u6d3b\u52a8\u4ee5\u4fdd\u8bc1 Chunk \u88ab\u5b8c\u5168\u590d\u5236,\n\u5728\u6240\u6709\u7684 Chunk \u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861, \u56de\u6536\u4e0d\u518d\u4f7f\u7528\u7684\u5b58\u50a8\u7a7a\u95f4")),(0,i.kt)("h5",{id:"\u540d\u79f0\u7a7a\u95f4\u9501"},"\u540d\u79f0\u7a7a\u95f4\u9501"),(0,i.kt)("p",null,"\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u90fd\u83b7\u53d6\u4e00\u4e2a\u76ee\u5f55\u540d\u7684\u4e0a\u7684\u8bfb\u53d6\u9501\u548c\u6587\u4ef6\u540d\u4e0a\u7684\u5199\u5165\u9501.\n\u76ee\u5f55\u540d\u7684\u8bfb\u53d6\u9501\u8db3\u4ee5\u7684\u9632\u6b62\u76ee\u5f55\u88ab\u5220\u9664\u3001\u6539\u540d\u4ee5\u53ca\u88ab\u5feb\u7167.\n\u6587\u4ef6\u540d\u7684\u5199\u5165\u9501\u5e8f\u5217\u5316\u6587\u4ef6\u521b\u5efa\u64cd\u4f5c, \u786e\u4fdd\u4e0d\u4f1a\u591a\u6b21\u521b\u5efa\u540c\u540d\u7684\u6587\u4ef6."),(0,i.kt)("h5",{id:"chunk-\u526f\u672c\u5e73\u8861"},"Chunk \u526f\u672c\u5e73\u8861"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5e73\u8861\u786c\u76d8\u4f7f\u7528\u7387"),(0,i.kt)("li",{parentName:"ul"},"\u9650\u5236\u540c\u4e00\u53f0 Chunk \u670d\u52a1\u5668\u4e0a\u7684\u6b63\u5728\u8fdb\u884c\u7684\u514b\u9686\u64cd\u4f5c\u7684\u6570\u91cf"),(0,i.kt)("li",{parentName:"ul"},"\u5728\u673a\u67b6\u95f4\u5206\u5e03\u526f\u672c")),(0,i.kt)("h5",{id:"\u5783\u573e\u56de\u6536"},"\u5783\u573e\u56de\u6536"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u56de\u6536\u8fc7\u671f(\u7248\u672c\u53f7\u4e0d\u4e00\u81f4)\u548c\u635f\u574f\u7684 Chunk."),(0,i.kt)("li",{parentName:"ul"},"GFS \u7a7a\u95f4\u56de\u6536\u91c7\u7528\u60f0\u6027\u7684\u7b56\u7565: \u53ea\u5728\u6587\u4ef6\u548c Chunk \u7ea7\u7684\u5e38\u89c4\u5783\u573e\u6536\u96c6\u65f6\u8fdb\u884c\u771f\u6b63\u7684\u5220\u9664\u64cd\u4f5c."),(0,i.kt)("li",{parentName:"ul"},"\u5783\u573e\u56de\u6536\u628a\u5b58\u50a8\u7a7a\u95f4\u7684\u56de\u6536\u64cd\u4f5c\u5408\u5e76\u5230 Master \u8282\u70b9\u89c4\u5f8b\u6027\u7684\u540e\u53f0\u6d3b\u52a8\u4e2d(\u4f8b\u884c\u626b\u63cf\u548c\u4e0e Chunk \u670d\u52a1\u5668\u63e1\u624b).")),(0,i.kt)("h4",{id:"\u5bb9\u9519\u6027"},"\u5bb9\u9519\u6027"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5feb\u901f\u81ea\u542f\u52a8"),(0,i.kt)("li",{parentName:"ul"},"Chunk \u526f\u672c"),(0,i.kt)("li",{parentName:"ul"},"Master \u670d\u52a1\u5668\u526f\u672c"),(0,i.kt)("li",{parentName:"ul"},"Chunk Checksum \u68c0\u9a8c\u6570\u636e\u5b8c\u6574\u6027")),(0,i.kt)("h3",{id:"map-reduce"},"Map Reduce"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5206\u5272\u8f93\u5165\u6570\u636e (\u6570\u636e\u5206\u5e03)"),(0,i.kt)("li",{parentName:"ul"},"\u96c6\u7fa4\u8c03\u5ea6 (\u8d1f\u8f7d\u5747\u8861)"),(0,i.kt)("li",{parentName:"ul"},"\u9519\u8bef\u5904\u7406 (\u5bb9\u9519)"),(0,i.kt)("li",{parentName:"ul"},"\u96c6\u7fa4\u901a\u4fe1")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u7528\u6237\u7a0b\u5e8f\u9996\u5148\u8c03\u7528\u7684 MapReduce \u5e93\u5c06\u8f93\u5165\u6587\u4ef6\u5206\u6210 M \u4e2a\u6570\u636e\u7247\u5ea6\uff0c\u6bcf\u4e2a\u6570\u636e\u7247\u6bb5\u7684\u5927\u5c0f\u4e00\u822c\u4ece\n16MB \u5230 64MB(\u53ef\u4ee5\u901a\u8fc7\u53ef\u9009\u7684\u53c2\u6570\u6765\u63a7\u5236\u6bcf\u4e2a\u6570\u636e\u7247\u6bb5\u7684\u5927\u5c0f)\u3002\u7136\u540e\u7528\u6237\u7a0b\u5e8f\u5728\u673a\u7fa4\u4e2d\u521b\u5efa\u5927\u91cf\n\u7684\u7a0b\u5e8f\u526f\u672c\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u8fd9\u4e9b\u7a0b\u5e8f\u526f\u672c\u4e2d\u7684\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u7a0b\u5e8f\u2013master\u3002\u526f\u672c\u4e2d\u5176\u5b83\u7684\u7a0b\u5e8f\u90fd\u662f worker \u7a0b\u5e8f\uff0c\u7531 master \u5206\u914d\n\u4efb\u52a1\u3002\u6709 M \u4e2a Map \u4efb\u52a1\u548c R \u4e2a Reduce \u4efb\u52a1\u5c06\u88ab\u5206\u914d\uff0cmaster \u5c06\u4e00\u4e2a Map \u4efb\u52a1\u6216 Reduce \u4efb\u52a1\u5206\u914d\n\u7ed9\u4e00\u4e2a\u7a7a\u95f2\u7684 worker\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u88ab\u5206\u914d\u4e86 map \u4efb\u52a1\u7684 worker \u7a0b\u5e8f\u8bfb\u53d6\u76f8\u5173\u7684\u8f93\u5165\u6570\u636e\u7247\u6bb5\uff0c\u4ece\u8f93\u5165\u7684\u6570\u636e\u7247\u6bb5\u4e2d\u89e3\u6790\u51fa key/value\npair\uff0c\u7136\u540e\u628a key/value pair \u4f20\u9012\u7ed9\u7528\u6237\u81ea\u5b9a\u4e49\u7684 Map \u51fd\u6570\uff0c\u7531 Map \u51fd\u6570\u751f\u6210\u5e76\u8f93\u51fa\u7684\u4e2d\u95f4 key/value\npair\uff0c\u5e76\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u7f13\u5b58\u4e2d\u7684 key/value pair \u901a\u8fc7\u5206\u533a\u51fd\u6570\u5206\u6210 R \u4e2a\u533a\u57df\uff0c\u4e4b\u540e\u5468\u671f\u6027\u7684\u5199\u5165\u5230\u672c\u5730\u78c1\u76d8\u4e0a\u3002\u7f13\u5b58\u7684\nkey/value pair \u5728\u672c\u5730\u78c1\u76d8\u4e0a\u7684\u5b58\u50a8\u4f4d\u7f6e\u5c06\u88ab\u56de\u4f20\u7ed9 master\uff0c\u7531 master \u8d1f\u8d23\u628a\u8fd9\u4e9b\u5b58\u50a8\u4f4d\u7f6e\u518d\u4f20\u9001\u7ed9\nReduce worker\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u5f53 Reduce worker \u7a0b\u5e8f\u63a5\u6536\u5230 master \u7a0b\u5e8f\u53d1\u6765\u7684\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\u4fe1\u606f\u540e\uff0c\u4f7f\u7528 RPC \u4ece Map worker \u6240\u5728\n\u4e3b\u673a\u7684\u78c1\u76d8\u4e0a\u8bfb\u53d6\u8fd9\u4e9b\u7f13\u5b58\u6570\u636e\u3002\u5f53 Reduce worker \u8bfb\u53d6\u4e86\u6240\u6709\u7684\u4e2d\u95f4\u6570\u636e\u540e\uff0c\u901a\u8fc7\u5bf9 key \u8fdb\u884c\u6392\u5e8f\n\u540e\u4f7f\u5f97\u5177\u6709\u76f8\u540c key \u503c\u7684\u6570\u636e\u805a\u5408\u5728\u4e00\u8d77\u3002\u7531\u4e8e\u8bb8\u591a\u4e0d\u540c\u7684 key \u503c\u4f1a\u6620\u5c04\u5230\u76f8\u540c\u7684 Reduce \u4efb\u52a1\u4e0a\uff0c\n\u56e0\u6b64\u5fc5\u987b\u8fdb\u884c\u6392\u5e8f\u3002\u5982\u679c\u4e2d\u95f4\u6570\u636e\u592a\u5927\u65e0\u6cd5\u5728\u5185\u5b58\u4e2d\u5b8c\u6210\u6392\u5e8f\uff0c\u90a3\u4e48\u5c31\u8981\u5728\u5916\u90e8\u8fdb\u884c\u6392\u5e8f\u3002"),(0,i.kt)("li",{parentName:"ol"},"Reduce worker \u7a0b\u5e8f\u904d\u5386\u6392\u5e8f\u540e\u7684\u4e2d\u95f4\u6570\u636e\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u552f\u4e00\u7684\u4e2d\u95f4 key \u503c\uff0cReduce worker \u7a0b\u5e8f\u5c06\u8fd9\n\u4e2a key \u503c\u548c\u5b83\u76f8\u5173\u7684\u4e2d\u95f4 value \u503c\u7684\u96c6\u5408\u4f20\u9012\u7ed9\u7528\u6237\u81ea\u5b9a\u4e49\u7684 Reduce \u51fd\u6570\u3002Reduce \u51fd\u6570\u7684\u8f93\u51fa\u88ab\u8ffd\n\u52a0\u5230\u6240\u5c5e\u5206\u533a\u7684\u8f93\u51fa\u6587\u4ef6\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u5f53\u6240\u6709\u7684 Map \u548c Reduce \u4efb\u52a1\u90fd\u5b8c\u6210\u4e4b\u540e\uff0cmaster \u5524\u9192\u7528\u6237\u7a0b\u5e8f\u3002\u5728\u8fd9\u4e2a\u65f6\u5019\uff0c\u5728\u7528\u6237\u7a0b\u5e8f\u91cc\u7684\u5bf9\nMapReduce \u8c03\u7528\u624d\u8fd4\u56de\u3002")),(0,i.kt)("h3",{id:"google-big-table"},"Google Big Table"),(0,i.kt)("p",null,"BigTable \u662f\u4e00\u4e2a\u7a00\u758f\u7684\u3001\u5206\u5e03\u5f0f\u7684\u3001\u6301\u4e45\u5316\u5b58\u50a8\u7684\u591a\u7ef4\u5ea6\u6392\u5e8f,\nMap: ",(0,i.kt)("inlineCode",{parentName:"p"},"(row: string, column: string, time: int64) -> string"),"."),(0,i.kt)("h4",{id:"\u6570\u636e\u6a21\u578b"},"\u6570\u636e\u6a21\u578b"),(0,i.kt)("h5",{id:"\u884c"},"\u884c"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u540c\u4e00\u4e2a\u884c\u5173\u952e\u5b57\u7684\u8bfb\u6216\u8005\u5199\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u7684"),(0,i.kt)("li",{parentName:"ul"},"BigTable \u901a\u8fc7\u884c\u5173\u952e\u5b57\u7684\u5b57\u5178\u987a\u5e8f\u6765\u7ec4\u7ec7\u6570\u636e"),(0,i.kt)("li",{parentName:"ul"},'\u8868\u4e2d\u7684\u6bcf\u4e2a\u884c\u90fd\u53ef\u4ee5\u52a8\u6001\u5206\u533a, \u6bcf\u4e2a\u5206\u533a\u53eb\u505a\u4e00\u4e2a "Tablet"'),(0,i.kt)("li",{parentName:"ul"},"Tablet \u662f\u6570\u636e\u5206\u5e03\u548c\u8d1f\u8f7d\u5747\u8861\u8c03\u6574\u7684\u6700\u5c0f\u5355\u4f4d")),(0,i.kt)("h5",{id:"\u5217\u65cf"},"\u5217\u65cf"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'\u5217\u5173\u952e\u5b57\u7ec4\u6210\u7684\u96c6\u5408\u53eb\u505a "\u5217\u65cf", \u5217\u65cf\u662f\u8bbf\u95ee\u63a7\u5236\u7684\u57fa\u672c\u5355\u4f4d'),(0,i.kt)("li",{parentName:"ul"},"\u5b58\u653e\u5728\u540c\u4e00\u5217\u65cf\u4e0b\u7684\u6240\u6709\u6570\u636e\u901a\u5e38\u90fd\u5c5e\u4e8e\u540c\u4e00\u4e2a\u7c7b\u578b"),(0,i.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u63a7\u5236\u3001\u78c1\u76d8\u548c\u5185\u5b58\u7684\u4f7f\u7528\u7edf\u8ba1\u90fd\u662f\u5728\u5217\u65cf\u5c42\u9762\u8fdb\u884c\u7684")),(0,i.kt)("h5",{id:"\u65f6\u95f4\u6233"},"\u65f6\u95f4\u6233"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5728 BigTable \u4e2d, \u8868\u7684\u6bcf\u4e00\u4e2a\u6570\u636e\u9879\u90fd\u53ef\u4ee5\u5305\u542b\u540c\u4e00\u4efd\u6570\u636e\u7684\u4e0d\u540c\u7248\u672c"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u540c\u7248\u672c\u7684\u6570\u636e\u901a\u8fc7\u65f6\u95f4\u6233\u6765\u7d22\u5f15")),(0,i.kt)("h4",{id:"\u4f9d\u8d56"},"\u4f9d\u8d56"),(0,i.kt)("h5",{id:"sstable"},"SSTable"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"BigTable \u5185\u90e8\u5b58\u50a8\u6570\u636e\u7684\u6587\u4ef6\u662f Google SSTable \u683c\u5f0f\u7684, SSTable \u662f\u4e00\u4e2a\u6301\u4e45\u5316\u7684\u3001\u6392\u5e8f\u7684\u3001\u4e0d\u53ef\u66f4\u6539\u7684 Map \u7ed3\u6784"),(0,i.kt)("li",{parentName:"ul"},"SSTable \u4f7f\u7528\u5757\u7d22\u5f15\uff08\u901a\u5e38\u5b58\u50a8\u5728 SSTable \u7684\u6700\u540e\uff09\u6765\u5b9a\u4f4d\u6570\u636e\u5757"),(0,i.kt)("li",{parentName:"ul"},"\u5728\u6253\u5f00 SSTable \u7684\u65f6\u5019\uff0c\u7d22\u5f15\u88ab\u52a0\u8f7d\u5230\u5185\u5b58"),(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u6b21\u67e5\u627e\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e00\u6b21\u78c1\u76d8\u641c\u7d22\u5b8c\u6210: \u9996\u5148\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u6cd5\u5728\u5185\u5b58\u4e2d\u7684\u7d22\u5f15\u91cc\u627e\u5230\u6570\u636e\u5757\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u518d\u4ece\u786c\u76d8\u8bfb\u53d6\u76f8\u5e94\u7684\u6570\u636e\u5757")),(0,i.kt)("h5",{id:"chubby"},"Chubby"),(0,i.kt)("p",null,"BigTable \u4f7f\u7528 Chubby \u5b8c\u6210\u4ee5\u4e0b\u7684\u51e0\u4e2a\u4efb\u52a1\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u786e\u4fdd\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u65f6\u95f4\u5185\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u6d3b\u52a8\u7684 Master \u526f\u672c"),(0,i.kt)("li",{parentName:"ol"},"\u5b58\u50a8 BigTable \u6570\u636e\u7684\u81ea\u5f15\u5bfc\u6307\u4ee4\u7684\u4f4d\u7f6e"),(0,i.kt)("li",{parentName:"ol"},"\u67e5\u627e Tablet \u670d\u52a1\u5668\uff0c\u4ee5\u53ca\u5728 Tablet \u670d\u52a1\u5668\u5931\u6548\u65f6\u8fdb\u884c\u5584\u540e"),(0,i.kt)("li",{parentName:"ol"},"\u5b58\u50a8 BigTable \u7684\u6a21\u5f0f\u4fe1\u606f(\u6bcf\u5f20\u8868\u7684\u5217\u65cf\u4fe1\u606f)"),(0,i.kt)("li",{parentName:"ol"},"\u5b58\u50a8\u8bbf\u95ee\u63a7\u5236\u5217\u8868")),(0,i.kt)("h4",{id:"\u7ec4\u4ef6"},"\u7ec4\u4ef6"),(0,i.kt)("p",null,"BigTable \u5305\u62ec\u4e86\u4e09\u4e2a\u4e3b\u8981\u7684\u7ec4\u4ef6: \u94fe\u63a5\u5230\u5ba2\u6237\u7a0b\u5e8f\u4e2d\u7684\u5e93\u3001\u4e00\u4e2a Master \u670d\u52a1\u5668\u548c\u591a\u4e2a Tablet \u670d\u52a1\u5668"),(0,i.kt)("h5",{id:"master-\u670d\u52a1\u5668"},"Master \u670d\u52a1\u5668"),(0,i.kt)("p",null,"Master \u670d\u52a1\u5668\u4e3b\u8981\u8d1f\u8d23\u4ee5\u4e0b\u5de5\u4f5c\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e3a Tablet \u670d\u52a1\u5668\u5206\u914d Tablets"),(0,i.kt)("li",{parentName:"ul"},"\u68c0\u6d4b\u65b0\u52a0\u5165\u7684\u6216\u8005\u8fc7\u671f\u5931\u6548\u7684 Table \u670d\u52a1\u5668"),(0,i.kt)("li",{parentName:"ul"},"\u5bf9 Tablet \u670d\u52a1\u5668\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861"),(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u4fdd\u5b58\u5728 GFS \u4e0a\u7684\u6587\u4ef6\u8fdb\u884c\u5783\u573e\u6536\u96c6"),(0,i.kt)("li",{parentName:"ul"},"\u5904\u7406\u5bf9\u6a21\u5f0f\u7684\u76f8\u5173\u4fee\u6539\u64cd\u4f5c, \u4f8b\u5982\u5efa\u7acb\u8868\u548c\u5217\u65cf")),(0,i.kt)("h5",{id:"tablet-\u670d\u52a1\u5668"},"Tablet \u670d\u52a1\u5668"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a Tablet \u670d\u52a1\u5668\u90fd\u7ba1\u7406\u4e00\u4e2a Tablet \u7684\u96c6\u5408\uff08\u901a\u5e38\u6bcf\u4e2a\u670d\u52a1\u5668\u6709\u5927\u7ea6\u6570\u5341\u4e2a\u81f3\u4e0a\u5343\u4e2a Tablet\uff09"),(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a Tablet \u670d\u52a1\u5668\u8d1f\u8d23\u5904\u7406\u5b83\u6240\u52a0\u8f7d\u7684 Tablet \u7684\u8bfb\u5199\u64cd\u4f5c"),(0,i.kt)("li",{parentName:"ul"},"\u5728 Tablets \u8fc7\u5927\u65f6\uff0c\u5bf9\u5176\u8fdb\u884c\u5206\u5272")),(0,i.kt)("h4",{id:"\u5b9e\u73b0"},"\u5b9e\u73b0"),(0,i.kt)("h5",{id:"\u5b9a\u4f4d"},"\u5b9a\u4f4d"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u4e09\u5c42 B+ \u6811\u7ed3\u6784\u5b58\u50a8 Tablets \u7684\u4f4d\u7f6e\u4fe1\u606f (\u4f4d\u4e8e\u54ea\u4e2a Tablet \u670d\u52a1\u5668\u4e0a)"),(0,i.kt)("li",{parentName:"ul"},"MetaTablet \u4e2d \u7684 row key \u662f\u901a\u8fc7 table id \u548c end row \u6765\u8ba1\u7b97\u51fa\u7684:\n\u56e0\u4e3a row \u662f\u6709\u5e8f\u7684, \u6240\u4ee5\u5728\u8bfb\u53d6 row/column \u578b\u7684\u6570\u636e\u65f6\u53ef\u4ee5\u5229\u7528\u5230\u6709\u5e8f\u6027.")),(0,i.kt)("h5",{id:"\u670d\u52a1"},"\u670d\u52a1"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5f53\u5199\u5165\u8868\u65f6, \u5148\u5199\u65e5\u5fd7, \u518d\u5199\u5165\u5185\u5b58\u4e2d\u7684 memTable, \u5f53\u5176\u5927\u5c0f\u8fbe\u5230\u9608\u503c\u540e, \u5199\u5165 GFS \u4e2d (\u4ee5 SSTable \u5b58\u50a8)"),(0,i.kt)("li",{parentName:"ul"},"\u5229\u7528 Log-Structured Merge Tree \u6765\u8868\u793a memTable \u548c SSTable \u4e4b\u95f4\u7684\u5173\u7cfb (\u5185\u5b58\u6570\u636e\u6eda\u52a8\u5408\u5e76\u81f3\u78c1\u76d8)"),(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u4e00\u81f4\u6027\u7684\u5904\u7406\uff0c\u5c06 SSTable \u4e0d\u53ef\u6539\u53d8\u5316\uff0c\u7136\u540e\u5bf9 memTable \u4f7f\u7528 copy-on-write \u6280\u672f\u5b9e\u73b0\u8bfb\u5199\u5e76\u884c")),(0,i.kt)("h2",{id:"unikernel"},"Unikernel"),(0,i.kt)("p",null,"\u5c0f\u3001\u7b80\u5355\u3001\u5b89\u5168\u3001\u9ad8\u6548"),(0,i.kt)("p",null,"Fast, Small, Secure Workloads"),(0,i.kt)("p",null,"Containers are Smaller and Faster, but Security is Still an Issue"),(0,i.kt)("p",null,"SELinux: \u5728\u4e00\u4e2a\u5f00\u542f\u4e86 SELinux \u7684\u5185\u6838\u4e2d, \u53ef\u80fd\u5b58\u5728 10 \u4e07\u6761\u4ee5\u4e0a\u7684\u5b89\u5168\u7b56\u7565, \u6709\u65f6\u65e0\u6cd5\u6b63\u5e38\u542f\u52a8\u670d\u52a1 (\u7f3a\u5c11\u6743\u9650)"),(0,i.kt)("h3",{id:"unikernels"},"Unikernels"),(0,i.kt)("p",null,"Unikernels do at compile time what standard programs do at runtime:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Most unikernels use a specialized compiling system\nthat compiles in the low-level functions the developer has selected"),(0,i.kt)("li",{parentName:"ul"},"The code for these low-level functions is\ncompiled directly into the application executable through a library operating system"),(0,i.kt)("li",{parentName:"ul"},"library operating system: a special collection of libraries\nthat provides needed operating system functions in a compilable format")),(0,i.kt)("h4",{id:"security"},"Security"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"There is no command shell to leverage"),(0,i.kt)("li",{parentName:"ul"},"There are no utilities to co-opt"),(0,i.kt)("li",{parentName:"ul"},"There are no unused device drivers or unused libraries to attack"),(0,i.kt)("li",{parentName:"ul"},"There are no password files or authorization information present"),(0,i.kt)("li",{parentName:"ul"},"There are no connections to machines and databases not needed by the application")),(0,i.kt)("h4",{id:"debug"},"Debug"),(0,i.kt)("p",null,"Since there is no operating system environment on a unikernel production VM,\nthere are no tools, no debuggers,\nno shell access with which someone can probe a failure on a deployed program."),(0,i.kt)("p",null,"Instead, all that can be done is to engineer the executable to log events and data\nso that the failure might be reconstructed on a development system,\nwhich still has access to all the debugging tools needed."),(0,i.kt)("p",null,"People in our industry have successfully debugged failures of complex software\nfor years without direct access to production systems,\nand I see no reason why they will fail to do so now."),(0,i.kt)("h4",{id:"limits"},"Limits"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Single Process (but Multiple Threads)"),(0,i.kt)("li",{parentName:"ul"},"Single User"),(0,i.kt)("li",{parentName:"ul"},"Limited Debugging"),(0,i.kt)("li",{parentName:"ul"},"Impoverished Library Ecosystem")),(0,i.kt)("h4",{id:"ecosystem"},"Ecosystem"),(0,i.kt)("h5",{id:"clickos"},"ClickOS"),(0,i.kt)("p",null,"network function virtualization (NFV) devices"),(0,i.kt)("h5",{id:"rumprun"},"RumpRun"),(0,i.kt)("p",null,"compile most of the programs found on a Linux or Unix-like operating system as unikernels"),(0,i.kt)("h5",{id:"osv"},"OSv"),(0,i.kt)("p",null,"It is unique among existing unikernels in that\nit provides a general-purpose unikernel base that can accept just about any program\nthat can run in a single process\n(multiple threads are allowed, but multiple processes are not)."),(0,i.kt)("p",null,'As a result, OSv is a "fat" unikernel:\nthe results are measured in megabytes, rather than kilobytes.'),(0,i.kt)("h5",{id:"mini-os"},"Mini-OS"),(0,i.kt)("p",null,"Mini-OS is a tiny OS kernel distributed with the Xen Project Hypervisor sources:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"used as operating system for stub domains that are used for Dom0 Disaggregation."),(0,i.kt)("li",{parentName:"ul"},"used as a basis for development of Unikernels,\nhaving been instrumental in the formation of multiple examples\nincluding ClickOS and Rump kernels.")),(0,i.kt)("h5",{id:"xen"},"Xen"),(0,i.kt)("p",null,"Its paravirtualization capabilities allow unikernels to\nhave a very small and efficient footprint interfacing with devices.\nThis is one reason why the Xen Project has been at the forefront of unikernel development."),(0,i.kt)("p",null,"Xen team has been consciously reworking the hypervisor\u2019s capabilities\nso it can handle a future state where 2,000 or 3,000 simultaneous unikernel VMs\nmay need to coexist on a single hardware host server.\nCurrently, the hypervisor can handle about 1,000 unikernels simultaneously\nbefore scaling becomes nonlinear.\nThe development work continues to improve unikernel support in each release."),(0,i.kt)("h5",{id:"unik"},"Unik"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"UniK is an open source tool written in Go\nfor compiling applications into unikernels and deploying those unikernels."),(0,i.kt)("li",{parentName:"ul"},"UniK utilizes a simple Docker-like command-line interface,\nmaking developing on unikernels as easy as developing on containers.")),(0,i.kt)("h3",{id:"libos"},"libOS"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"implement drivers for the virtual hardware devices provided by the hypervisor"),(0,i.kt)("li",{parentName:"ul"},"create the protocol libraries to replace the services of a traditional OS")),(0,i.kt)("p",null,"the kernel is event-driven via an I/O loop that polls Xen devices"),(0,i.kt)("h3",{id:"opam"},"OPAM"),(0,i.kt)("p",null,"modern modular, functional and type-safe programming language"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"opam install\nopam update -u\nopam switch\nopam remote\nopam depext\n")),(0,i.kt)("h3",{id:"mirageos"},"MirageOS"),(0,i.kt)("p",null,"Exokernel -> Library Operating System -> Unikernel:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Unikernels"),": specialized, sealed, single purpose libOS VMs\nthat run directly on the hypervisor"),(0,i.kt)("li",{parentName:"ul"},"A libOS is structured very differently from a conventional OS:\nall services, from the scheduler to the device drivers to the network stack,\nare implemented as libraries linked directly with the application."),(0,i.kt)("li",{parentName:"ul"},"Coupled with the choice of a modern statically type-safe language\nfor implementation, this affords configuration,\nperformance and security benefits to unikernels."),(0,i.kt)("li",{parentName:"ul"},"the current release contains clean-slate libraries for\nTLS, TCP/IP, DNS, Xen network and storage device drivers, HTTP\nand other common Internet protocols.")),(0,i.kt)("h4",{id:"installation"},"Installation"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"opam init\nopam remote\nocaml -version\nopam switch 4.04.2\neval `opam config env`\nopam list\nopam install mirage\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"mirage --help\nmirage configure --xen\nmake depend\nmake\nsudo xl create -c console.xl\nstrip console.xen\nbzip2 -9 console.xen\n")),(0,i.kt)("h4",{id:"development"},"Development"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"opam source repo.name --dev-repo --pin\n")),(0,i.kt)("h4",{id:"use-of-ocaml"},"Use of OCaml"),(0,i.kt)("p",null,"OCaml is a pragmatic system that strikes a balance between imperative languages,\ne.g., C, and pure functional languages, e.g., Haskell.\nIt features type inference, algebraic data types, and higher-order functions,\nbut also permits references and mutable data structures\nwhile guaranteeing that all such side-effects are always type safe\nand will never cause memory corruption."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"(ICFP'10) a full-fledged systems programming language\nwith a flexible programming model that supports functional,\nimperative and object-oriented programming"),(0,i.kt)("li",{parentName:"ul"},"OCaml has a simple yet high performance runtime making it\nan ideal platform for experimenting with\nthe unikernel abstraction that interfaces the runtime with Xen."),(0,i.kt)("li",{parentName:"ul"},"static typing eliminates type information at compile-time\nwhile retaining all the benefits of type-safety\n(remove dynamic typing overheads and introduce more safety at compile time)."),(0,i.kt)("li",{parentName:"ul"},"(SOSP'03/11) the open-source Xen Cloud Platform and critical system components\nare implemented in OCaml, making integration straightforward.")),(0,i.kt)("h5",{id:"concurrency"},"Concurrency"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"lightweight control-flow threads for managing I/O and timeouts"),(0,i.kt)("li",{parentName:"ul"},"optimized inter-VM communication for parallel computation")),(0,i.kt)("p",null,"Each Mirage instance runs as on a single CPU core.\nCommunication is optimized dynamically:\nif the VMs are running on the same physical machine,\nMirage uses shared memory channels instead of the network stack."),(0,i.kt)("h5",{id:"thread-flow"},"Thread Flow"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The application\u2019s main thread is launched immediately\nafter boot and the VM shuts down when it returns."),(0,i.kt)("li",{parentName:"ul"},"Mirage provides an evaluator that uses domain poll\nto listen for events and wake up lightweight threads.\nThe VM is thus either executing OCaml code or blocked,\nwith no internal preemption or asynchronous interrupts."),(0,i.kt)("li",{parentName:"ul"},"The main thread repeatedly executes until it completes or throws an exception,\nand the domain subsequently shuts down with the VM exit code\nmatching the thread return value.")),(0,i.kt)("h4",{id:"device-drivers"},"Device Drivers"),(0,i.kt)("p",null,"Data arrives to both the network and storage stacks\nas a stream of discrete packets.\nMirage bridges the gap between packets and streams\nby using channel iterates that map functions over infinite streams of packets\nto produce a typed stream."),(0,i.kt)("h4",{id:"io-stack"},"I/O Stack"),(0,i.kt)("p",null,"Mirage implements a Xen block front VFS which interacts directly\nwith a block device without an intervening filesystem."),(0,i.kt)("h2",{id:"xen-soft-device"},"Xen Soft Device"),(0,i.kt)("p",null,"Device-level interfaces in operating systems\npresent a very useful cut-point for researchers to experiment with new ideas.\nBy virtualizing these interfaces, developers can create soft devices,\nwhich are used in the same way as normal hardware devices,\nbut provide extra functionality in software."),(0,i.kt)("p",null,"Rather than attempting to present\na fully virtualized hardware interface to each OS in a Xen environment,\nguest OSes are modified to use a simple, narrow and idealized view of hardware.\nSoft devices take advantage of these narrow interface to\ncapture and transform block requests, network packets, and USB messages."),(0,i.kt)("h3",{id:"device-access-in-xen"},"Device Access in Xen"),(0,i.kt)("p",null,"Physical driver runs in an isolated VM,\nconnected over a shared memory device channel\nto a guest VM accessing the device.\nOperating systems wishing to access the device\nwill use a front-end driver,\nand interact with the back-end driver over a device channel,\nwhich is a shared-memory communications primitive (\u539f\u8bed)."),(0,i.kt)("h2",{id:"memory-management"},"Memory Management"),(0,i.kt)("h3",{id:"direct-segment"},"Direct Segment"),(0,i.kt)("p",null,"In light of the high cost of page-based virtual memory\nand its significant mismatch to \u201cbig-memory\u201d application needs,\nwe propose mapping part of a process\u2019s linear virtual address\nwith a direct segment rather than pages."),(0,i.kt)("p",null,"Mapping part of a process\u2019s linear virtual address space with a direct segment,\nwhile page mapping the rest of the virtual address space:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"retains a standard linear virtual address space"),(0,i.kt)("li",{parentName:"ul"},"is not overlaid on top of paging"),(0,i.kt)("li",{parentName:"ul"},"coexists with paging of other virtual addresses"),(0,i.kt)("li",{parentName:"ul"},"a one-time fixed-cost solution for any size memory")),(0,i.kt)("h4",{id:"large-pages-shortcoming"},"Large Pages Shortcoming"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Being a cache, TLBs are reliant on memory-access locality to be effective\nand it can be a mismatch for future big-memory workloads with poor locality"),(0,i.kt)("li",{parentName:"ul"},"efficient TLB support for multiple page sizes is difficult"),(0,i.kt)("li",{parentName:"ul"},"large page sizes are often few and far apart (not enough for big-memory workload)")),(0,i.kt)("h4",{id:"big-memory-workload-analysis"},"Big-memory workload analysis"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"While address translation can be accelerated by TLB hits,\nmisses are costly, taking up to 100s of cycles"),(0,i.kt)("li",{parentName:"ul"},"A sparse memory access pattern can result in more misses with fewer TLB entries")),(0,i.kt)("p",null,"For the majority of their address space, big-memory workloads do not require:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"swapping")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"fragmentation mitigation")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"fine-grained per-page protection")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Big-memory workloads pay a cost of page based virtual memory:\nsubstantial performance lost to TLB misses")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Big-memory workloads are long-running programs,\nreceive little benefit from virtual memory optimizations\nwhose primary goal is to allow quick program startup, such as demand paging")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Big-memory workloads consume almost all memory resources,\nare sized to match memory capacity")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Big-memory workloads isolate from other services,\nhave one (or a few) primary process(es)"))),(0,i.kt)("h4",{id:"hardware-support"},"Hardware Support"),(0,i.kt)("p",null,"direct segments add three registers per core as follows:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"BASE holds the start address of the contiguous virtual address range\nmapped through direct segment"),(0,i.kt)("li",{parentName:"ul"},"LIMIT holds the end address of the virtual address range\nmapped through direct segment"),(0,i.kt)("li",{parentName:"ul"},"OFFSET holds the start address of direct segment\u2019s backing\ncontiguous physical memory minus the value in BASE.")),(0,i.kt)("p",null,"Direct segments are aligned to the base page size,\nso page offset bits are omitted from these registers (e.g., 12 bits for 4KB pages)"),(0,i.kt)("p",null,"Without real direct segment hardware,\nwe emulate direct segment functionalities using 4KB pages"),(0,i.kt)("p",null,"More specifically, we modify Linux\u2019s page fault handler\nso that on a page fault within the primary region\nit calculates the corresponding physical address from the faulting virtual page number."),(0,i.kt)("p",null,"If VA fault is the 4KB page-aligned virtual address of a faulting page,\nthen our modified page-fault handler first checks if BASE \u2264 VA fault < LIMIT.\nIf so,\nthe handler adds a mapping from VA fault to VA fault + OFFSET to the page table."),(0,i.kt)("h4",{id:"software-support"},"Software Support"),(0,i.kt)("p",null,"The prototype implementation is simplified by assuming that only one process\nuses a direct segment at any time (called the primary process)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A primary region is a contiguous range of virtual addresses\nin a process\u2019s address space with uniform ",(0,i.kt)("strong",{parentName:"li"},"read-write")," access permission"),(0,i.kt)("li",{parentName:"ul"},"fine-grain protection, sparse allocation, swapping,\nand demand paging are not guaranteed for memory allocated within the primary region"),(0,i.kt)("li",{parentName:"ul"},"managing physical memory:\ncreate contiguous physical memory dynamically through periodic memory compaction"),(0,i.kt)("li",{parentName:"ul"},"managing direct segment registers:\nWhen the OS dispatches a thread;\nit loads the BASE, LIMIT, and OFFSET values from the PCB"),(0,i.kt)("li",{parentName:"ul"},"Growing and shrinking direct segment\n(by updating direct segment registers and page table entries)")),(0,i.kt)("h4",{id:"virtual-machines-with-direct-segment"},"Virtual Machines with Direct Segment"),(0,i.kt)("p",null,"In a virtualized environment the memory accesses\ngoes through two levels of address translations:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"guest virtual address (gVA) to guest physical address (gPA)"),(0,i.kt)("li",{parentName:"ol"},"guest physical address (gPA) to system physical address (sPA)")),(0,i.kt)("h4",{id:"results"},"Results"),(0,i.kt)("p",null,"In x86-64, page table entries (PTEs) have a set of reserved bits\n(41-51 in our test platform) that cause a trap when loaded into the TLB"),(0,i.kt)("h3",{id:"redundant-memory-mappings-rmm"},"Redundant Memory Mappings (RMM)"),(0,i.kt)("p",null,"\u5728\u5927\u5185\u5b58\u7cfb\u7edf\u4e2d, \u4f20\u7edf\u7684\u6bb5\u9875\u5f0f\u865a\u5b58\u7ba1\u7406\u6280\u672f\u5b58\u5728\u6027\u80fd\u95ee\u9898 (TLBs \u7684\u6709\u9650\u6027\u80fd):"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7531\u4e8e TLBs \u4e0d\u518d\u80fd\u8986\u76d6\u5de5\u4f5c\u96c6 (working sets: \u6307\u6d3b\u52a8\u9891\u7e41\u7684\u9875\u8868\u96c6), \u5bfc\u81f4 TLB \u7f3a\u5931 (TLB misses) \u6025\u5267\u4e0a\u5347"),(0,i.kt)("li",{parentName:"ul"},"\u5728\u4f20\u7edf\u5185\u5b58\u5c42\u6b21\u4e2d, \u5229\u7528 TLBs \u5b8c\u6210\u5730\u5740\u8f6c\u6362\u540e (\u865a\u62df\u5730\u5740 -> \u7269\u7406\u5730\u5740),\n\u9700\u8981\u4ece L1 Cache \u5f00\u59cb\u8fdb\u884c\u7f13\u5b58\u6807\u7b7e\u5339\u914d, \u67e5\u770b\u6240\u9700\u5185\u5b58\u6570\u636e\u662f\u5426\u5df2\u5728\u7f13\u5b58\u4e0a.\n\u56e0\u6b64\uff0c\u968f\u610f\u5730\u589e\u5927 TLB \u7684\u5927\u5c0f\u4ee5\u964d\u4f4e TLB \u7f3a\u5931\u7684\u65b9\u6cd5\u4f1a\u5f71\u54cd\u5230\u6240\u6709\u5185\u5b58\u64cd\u4f5c\u7684\u6027\u80fd (\u904d\u5386 TLB \u8868\u8017\u65f6\u589e\u5927)")),(0,i.kt)("p",null,"The amount of memory accessible from the TLB\nor The working set of each process is stored in the TLB:\nTLB Reach = (TLB Size) X (Page Size)"),(0,i.kt)("h4",{id:"old-methods"},"Old Methods"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Clustered TLBs/Multi-Page Mappings: mapping multiple pages per page table entry"),(0,i.kt)("li",{parentName:"ul"},"Transparent Huge Pages/Super-Paging: \u4f7f\u5f97\u6bcf\u4e2a\u9875\u8868\u9879\u8986\u76d6\u66f4\u5927\u7684\u5185\u5b58; \u4f46\u53d7\u9650\u4e8e\u67b6\u6784, \u9875\u9762\u5927\u5c0f\u6700\u5927\u4e3a 1GB"),(0,i.kt)("li",{parentName:"ul"},"Direct Segment: \u5c06\u4e00\u4e2a\u8fdb\u7a0b\u6240\u9700\u7684\u865a\u62df\u5185\u5b58\u76f4\u63a5\u6620\u5c04\u5230\u4e00\u4e2a\u5927\u6bb5\u4e2d; \u4f46\u4e0d\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u52a8\u6001\u5185\u5b58\u5206\u914d")),(0,i.kt)("h4",{id:"multi-page-mapping"},"Multi Page mapping"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"pack multiple page table entries(PTEs) into a single TLB entry"),(0,i.kt)("li",{parentName:"ul"},"they pack only a small multiple of translations per entry,\nwhich limits their potential to reduce page-walks for large working sets")),(0,i.kt)("h4",{id:"transparent-huge-pages"},"Transparent Huge pages"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"memory should be size-aligned and contiguous"),(0,i.kt)("li",{parentName:"ul"},"many commodity processors provide limited numbers of large page TLB entries")),(0,i.kt)("h4",{id:"direct-segment-method"},"Direct Segment Method"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"applications explicitly allocate a direct segment during ",(0,i.kt)("inlineCode",{parentName:"li"},"startup")),(0,i.kt)("li",{parentName:"ul"},"OS can reserve a single ",(0,i.kt)("inlineCode",{parentName:"li"},"large contiguous range")," of physical memory for a segment")),(0,i.kt)("h4",{id:"new-methods"},"New Methods"),(0,i.kt)("p",null,"two key challenges:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The address space of a process can\nbe decomposed into many chunks of variable length segments,\nwhich can be allocated dynamically"),(0,i.kt)("li",{parentName:"ul"},"address translation must be off the critical path:\nto support complicated many segment searches,\naddress translation may take much longer compared to\ntraditional fixed-sized page-based TLB lookups.")),(0,i.kt)("p",null,"changes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"hardware: range TLB, CR-RT (Control Register - Range Translation)"),(0,i.kt)("li",{parentName:"ul"},"software: process creation, memory allocation, range table management")),(0,i.kt)("h4",{id:"rmm-benefits"},"RMM Benefits"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"transparent")," to applications"),(0,i.kt)("li",{parentName:"ul"},"maps multiple ranges with ",(0,i.kt)("inlineCode",{parentName:"li"},"no size-alignment restrictions")),(0,i.kt)("li",{parentName:"ul"},"each range contains an ",(0,i.kt)("inlineCode",{parentName:"li"},"unrestricted amount of memory")),(0,i.kt)("li",{parentName:"ul"},"RMM has the potential to map more than 99% of memory\nfor all workloads with 50 or fewer range translations"),(0,i.kt)("li",{parentName:"ul"},"the range TLB achieves extremely high hit rates,\neliminating the vast majority of costly page-walks\ncompared to virtual memory systems that use paging alone.")),(0,i.kt)("p",null,"RMM performance depends on the range TLB achieving a high hit ratio with few entries"),(0,i.kt)("h4",{id:"range-translation"},"Range Translation"),(0,i.kt)("p",null,"Range translations are only base-page-aligned and redundant to paging:\nthe page table still maps the entire virtual address space"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"hardware: range TLBs"),(0,i.kt)("li",{parentName:"ul"},"software: range tables"),(0,i.kt)("li",{parentName:"ul"},"OS: change lazy demand page allocation to eager paging, ",(0,i.kt)("inlineCode",{parentName:"li"},"eager paging allocation"))),(0,i.kt)("p",null,"Eager paging instantiates pages in physical memory at ",(0,i.kt)("inlineCode",{parentName:"p"},"allocation request time"),",\nrather than at ",(0,i.kt)("inlineCode",{parentName:"p"},"first-access time")," as with demand paging."),(0,i.kt)("h4",{id:"range-table"},"Range Table"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"when miss: \u53ca\u65f6\u586b\u8865 PTE \u4ee5\u4f7f\u8bbf\u5b58\u64cd\u4f5c\u6b63\u5e38\u6267\u884c, \u5c06 Range TLB \u66f4\u65b0\u79fb\u51fa\u8bbf\u5b58\u5173\u952e\u8def\u5f84 (\u540e\u53f0\u66f4\u65b0)"),(0,i.kt)("li",{parentName:"ul"},"PTE \u52a0\u5165 range bit: \u8868\u793a\u5f53\u524d\u9875\u662f\u67d0\u4e2a Range \u7684\u4e00\u90e8\u5206, \u53ca\u65f6\u66f4\u65b0 Range TLB \u548c Range Table"),(0,i.kt)("li",{parentName:"ul"},"\u5229\u7528 CR-RT \u5bc4\u5b58\u5668\u8fdb\u884c Range Table \u67e5\u627e: OS handler \u53ef\u4ee5\u8fdb\u884c Range Table \u67e5\u627e, \u4ee5\u7b80\u5316\u786c\u4ef6\u8bbe\u8ba1"),(0,i.kt)("li",{parentName:"ul"},"\u4fee\u6539 INVLPG \u6307\u4ee4\uff1a \u4f7f\u5176\u540c\u65f6\u65e0\u6548\u5316 Range TLB")),(0,i.kt)("h4",{id:"contiguous-memory-allocation"},"Contiguous Memory Allocation"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"One motivation for demand paging was to\nlimit unnecessary swapping in multi-programmed workloads,\nwhich modern large memories make less common."),(0,i.kt)("li",{parentName:"ul"},"RMM trades increased memory for better performance,\na common tradeoff when memory is cheap and plentiful.")))}c.isMDXComponent=!0}}]);